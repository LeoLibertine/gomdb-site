<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Transacciones - Fraud Detection Live</title>
    <link href="https://fonts.googleapis.com/css2?family=Euclid+Circular+A:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --mongodb-green: #00ED64;
            --mongodb-navy: #001E2B;
            --mongodb-forest: #00684A;
            --mongodb-slate: #13AA52;
            --success: #00ED64;
            --warning: #FFC107;
            --danger: #DC3545;
        }

        body {
            font-family: 'Euclid Circular A', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--mongodb-navy);
            color: #ffffff;
            line-height: 1.7;
            overflow-x: hidden;
        }

        /* Animated Background */
        .background-gradient {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 237, 100, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 104, 74, 0.1) 0%, transparent 50%);
            animation: drift 15s ease-in-out infinite;
        }

        @keyframes drift {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(30px, 30px); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 60px 20px;
            margin-bottom: 60px;
        }

        .header-badge {
            display: inline-block;
            padding: 12px 24px;
            background: rgba(0, 237, 100, 0.15);
            border: 2px solid rgba(0, 237, 100, 0.4);
            border-radius: 50px;
            color: var(--mongodb-green);
            font-size: 0.9em;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 20px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(0, 237, 100, 0.3); }
            50% { transform: scale(1.05); box-shadow: 0 0 40px rgba(0, 237, 100, 0.6); }
        }

        .header h1 {
            font-size: 3.5em;
            font-weight: 800;
            background: linear-gradient(135deg, var(--mongodb-green) 0%, white 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
        }

        .header p {
            font-size: 1.3em;
            color: rgba(255, 255, 255, 0.7);
            max-width: 700px;
            margin: 0 auto;
        }

        /* Model Explanation - Enhanced */
        .explanation-section {
            margin-bottom: 80px;
        }

        .section-title {
            text-align: center;
            font-size: 2.8em;
            font-weight: 700;
            color: var(--mongodb-green);
            margin-bottom: 60px;
        }

        .model-flow {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            margin: 60px 0;
            flex-wrap: wrap;
        }

        .flow-step {
            flex: 1;
            min-width: 250px;
            background: rgba(0, 104, 74, 0.15);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(0, 237, 100, 0.3);
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            transition: all 0.4s ease;
            position: relative;
        }

        .flow-step:hover {
            transform: translateY(-10px) scale(1.05);
            border-color: var(--mongodb-green);
            box-shadow: 0 20px 40px rgba(0, 237, 100, 0.4);
        }

        .flow-step-number {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--mongodb-green), var(--mongodb-slate));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: 800;
            color: var(--mongodb-navy);
            box-shadow: 0 10px 20px rgba(0, 237, 100, 0.4);
        }

        .flow-icon {
            font-size: 4em;
            margin: 20px 0;
            filter: drop-shadow(0 10px 20px rgba(0, 237, 100, 0.3));
        }

        .flow-title {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--mongodb-green);
            margin-bottom: 15px;
        }

        .flow-description {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1em;
            line-height: 1.7;
        }

        .flow-arrow {
            font-size: 3em;
            color: var(--mongodb-green);
            opacity: 0.5;
            animation: slideArrow 2s ease-in-out infinite;
        }

        @keyframes slideArrow {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(15px); }
        }

        /* Interactive Demo Section */
        .demo-section {
            background: rgba(0, 104, 74, 0.08);
            border-radius: 32px;
            padding: 60px;
            margin: 60px 0;
            border: 2px solid rgba(0, 237, 100, 0.2);
        }

        .demo-title {
            font-size: 2.5em;
            color: var(--mongodb-green);
            text-align: center;
            margin-bottom: 40px;
        }

        .visual-pipeline {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            margin: 40px 0;
        }

        .pipeline-stage {
            background: rgba(0, 30, 43, 0.8);
            border: 2px solid rgba(0, 237, 100, 0.2);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .pipeline-stage.active {
            border-color: var(--mongodb-green);
            background: rgba(0, 104, 74, 0.3);
            animation: glowPulse 2s ease-in-out infinite;
        }

        @keyframes glowPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 237, 100, 0.3); }
            50% { box-shadow: 0 0 40px rgba(0, 237, 100, 0.6); }
        }

        .pipeline-stage::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--mongodb-green);
            transform: scaleX(0);
            transition: transform 0.5s ease;
        }

        .pipeline-stage.active::before {
            transform: scaleX(1);
        }

        .stage-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .stage-title {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--mongodb-green);
            margin-bottom: 10px;
        }

        .stage-status {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.5);
            min-height: 40px;
        }

        .stage-status.processing {
            color: var(--mongodb-green);
            animation: blink 1.5s ease-in-out infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Form Section - Enhanced */
        .form-section {
            background: rgba(0, 104, 74, 0.1);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(0, 237, 100, 0.3);
            border-radius: 32px;
            padding: 50px;
            margin-bottom: 60px;
        }

        .form-section h2 {
            font-size: 2.5em;
            color: var(--mongodb-green);
            margin-bottom: 30px;
            text-align: center;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .form-group label {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--mongodb-green);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group input,
        .form-group select {
            padding: 15px 20px;
            background: rgba(0, 30, 43, 0.6);
            border: 2px solid rgba(0, 237, 100, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 1.05em;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--mongodb-green);
            box-shadow: 0 0 20px rgba(0, 237, 100, 0.3);
        }

        .form-group select {
            cursor: pointer;
        }

        .form-group select option {
            background: var(--mongodb-navy);
            color: white;
            padding: 10px;
        }

        /* Custom Select Enhancement */
        .customer-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .warning-text {
            font-size: 0.9em;
            color: var(--warning);
            margin-top: 5px;
            display: none;
        }

        .warning-text.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .submit-btn {
            width: 100%;
            padding: 25px 40px;
            background: linear-gradient(135deg, var(--mongodb-green), var(--mongodb-slate));
            border: none;
            border-radius: 60px;
            color: var(--mongodb-navy);
            font-size: 1.4em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 10px 30px rgba(0, 237, 100, 0.4);
            position: relative;
            overflow: hidden;
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        .submit-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 237, 100, 0.6);
        }

        .submit-btn:active {
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Processing Modal */
        .processing-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 30, 43, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .processing-modal.show {
            display: flex;
        }

        .processing-content {
            background: rgba(0, 104, 74, 0.2);
            border: 2px solid var(--mongodb-green);
            border-radius: 32px;
            padding: 60px;
            max-width: 800px;
            text-align: center;
        }

        .processing-spinner {
            width: 100px;
            height: 100px;
            border: 8px solid rgba(0, 237, 100, 0.2);
            border-top: 8px solid var(--mongodb-green);
            border-radius: 50%;
            margin: 0 auto 30px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .processing-title {
            font-size: 2em;
            color: var(--mongodb-green);
            margin-bottom: 30px;
        }

        .processing-steps {
            text-align: left;
            max-width: 500px;
            margin: 0 auto;
        }

        .processing-step {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            margin: 10px 0;
            background: rgba(0, 30, 43, 0.6);
            border-radius: 12px;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }

        .processing-step.active {
            border-left-color: var(--mongodb-green);
            background: rgba(0, 104, 74, 0.3);
        }

        .processing-step.completed {
            border-left-color: var(--mongodb-green);
            opacity: 0.7;
        }

        .step-icon {
            font-size: 1.5em;
        }

        .step-text {
            flex: 1;
            font-size: 1.1em;
        }

        .step-status {
            font-size: 1.2em;
        }

        /* Result Section */
        .result-section {
            display: none;
            background: rgba(0, 104, 74, 0.1);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(0, 237, 100, 0.3);
            border-radius: 32px;
            padding: 50px;
            animation: slideUp 0.6s ease;
        }

        .result-section.show {
            display: block;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .decision-badge {
            display: inline-block;
            padding: 20px 50px;
            border-radius: 50px;
            font-size: 1.8em;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
            animation: popIn 0.5s ease;
        }

        @keyframes popIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .decision-approve {
            background: rgba(0, 237, 100, 0.2);
            color: var(--success);
            border: 3px solid var(--success);
        }

        .decision-flag {
            background: rgba(255, 193, 7, 0.2);
            color: var(--warning);
            border: 3px solid var(--warning);
        }

        .decision-block {
            background: rgba(220, 53, 69, 0.2);
            color: var(--danger);
            border: 3px solid var(--danger);
        }

        .score-container {
            text-align: center;
            margin: 40px 0;
        }

        .gauge {
            width: 320px;
            height: 160px;
            margin: 0 auto 30px;
            position: relative;
        }

        .gauge-background {
            width: 100%;
            height: 100%;
            border-radius: 160px 160px 0 0;
            background: linear-gradient(90deg, 
                var(--success) 0%, 
                var(--success) 30%, 
                var(--warning) 30%, 
                var(--warning) 60%, 
                var(--danger) 60%, 
                var(--danger) 100%);
            opacity: 0.3;
        }

        .gauge-needle {
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 5px;
            height: 150px;
            background: white;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(-90deg);
            transition: transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .gauge-needle::after {
            content: '';
            position: absolute;
            bottom: -18px;
            left: 50%;
            transform: translateX(-50%);
            width: 36px;
            height: 36px;
            background: var(--mongodb-green);
            border-radius: 50%;
            box-shadow: 0 0 30px var(--mongodb-green);
        }

        .score-value {
            font-size: 5em;
            font-weight: 800;
            background: linear-gradient(135deg, var(--mongodb-green), white);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: countUp 2s ease;
        }

        @keyframes countUp {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        .score-label {
            font-size: 1.3em;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 10px;
        }

        .factors-list {
            background: rgba(0, 30, 43, 0.6);
            border-radius: 20px;
            padding: 40px;
            margin-top: 30px;
        }

        .factors-list h3 {
            color: var(--mongodb-green);
            font-size: 2em;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .factor-item {
            background: rgba(0, 104, 74, 0.1);
            border-left: 5px solid var(--mongodb-green);
            padding: 25px;
            margin-bottom: 20px;
            border-radius: 12px;
            transition: all 0.3s ease;
            animation: slideInLeft 0.5s ease;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .factor-item:hover {
            background: rgba(0, 104, 74, 0.2);
            transform: translateX(10px);
        }

        .factor-name {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--mongodb-green);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .factor-desc {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.05em;
            line-height: 1.7;
        }

        .factor-weight {
            color: var(--warning);
            font-weight: 700;
            margin-top: 10px;
            font-size: 1.1em;
        }

        .transaction-details {
            background: rgba(0, 30, 43, 0.6);
            border-radius: 20px;
            padding: 40px;
            margin-top: 30px;
        }

        .transaction-details h3 {
            color: var(--mongodb-green);
            font-size: 2em;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 20px;
            background: rgba(0, 104, 74, 0.1);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .detail-item:hover {
            background: rgba(0, 104, 74, 0.2);
            transform: translateY(-5px);
        }

        .detail-label {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .detail-value {
            font-size: 1.3em;
            font-weight: 600;
            color: white;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .model-flow {
                flex-direction: column;
            }

            .flow-arrow {
                transform: rotate(90deg);
            }

            .visual-pipeline {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5em;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .visual-pipeline {
                grid-template-columns: 1fr;
            }

            .details-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="background-gradient"></div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-badge">üî¥ LIVE FRAUD DETECTION</div>
            <h1>Generador de Transacciones</h1>
            <p>Crea transacciones en tiempo real y observa paso a paso c√≥mo MongoDB Vector Search detecta fraudes en milisegundos</p>
        </div>

        <!-- Model Explanation - Visual Flow -->
        <section class="explanation-section">
            <h2 class="section-title">¬øC√≥mo Funciona el Modelo?</h2>
            
            <div class="model-flow">
                <div class="flow-step">
                    <div class="flow-step-number">1</div>
                    <div class="flow-icon">üß†</div>
                    <div class="flow-title">Vector Search</div>
                    <div class="flow-description">
                        Convierte el comportamiento en un vector de 384 n√∫meros y compara contra el perfil hist√≥rico usando similitud coseno
                    </div>
                </div>

                <div class="flow-arrow">‚Üí</div>

                <div class="flow-step">
                    <div class="flow-step-number">2</div>
                    <div class="flow-icon">‚öñÔ∏è</div>
                    <div class="flow-title">Risk Model</div>
                    <div class="flow-description">
                        Suma puntos por cada anomal√≠a: monto (+30), hora (+15), ubicaci√≥n (+25), dispositivo (+35)
                    </div>
                </div>

                <div class="flow-arrow">‚Üí</div>

                <div class="flow-step">
                    <div class="flow-step-number">3</div>
                    <div class="flow-icon">‚ö°</div>
                    <div class="flow-title">Change Streams</div>
                    <div class="flow-description">
                        MongoDB detecta la transacci√≥n instant√°neamente y dispara el an√°lisis en menos de 100ms
                    </div>
                </div>

                <div class="flow-arrow">‚Üí</div>

                <div class="flow-step">
                    <div class="flow-step-number">4</div>
                    <div class="flow-icon">üéØ</div>
                    <div class="flow-title">Decisi√≥n</div>
                    <div class="flow-description">
                        Aprobar (&lt;30), Revisar (30-85), o Bloquear (&gt;85) autom√°ticamente seg√∫n el score
                    </div>
                </div>
            </div>
        </section>

        <!-- Interactive Demo Section -->
        <section class="demo-section">
            <h2 class="demo-title">üé¨ Visualizaci√≥n del Pipeline de Detecci√≥n</h2>
            <p style="text-align: center; color: rgba(255, 255, 255, 0.7); font-size: 1.1em; margin-bottom: 40px;">
                Al enviar una transacci√≥n, observa c√≥mo cada etapa se activa en tiempo real
            </p>

            <div class="visual-pipeline" id="visualPipeline">
                <div class="pipeline-stage" id="stage1">
                    <div class="stage-icon">üìù</div>
                    <div class="stage-title">Transacci√≥n Recibida</div>
                    <div class="stage-status">Esperando...</div>
                </div>

                <div class="pipeline-stage" id="stage2">
                    <div class="stage-icon">üî¢</div>
                    <div class="stage-title">Vectorizaci√≥n</div>
                    <div class="stage-status">Pendiente</div>
                </div>

                <div class="pipeline-stage" id="stage3">
                    <div class="stage-icon">üîç</div>
                    <div class="stage-title">Vector Search</div>
                    <div class="stage-status">Pendiente</div>
                </div>

                <div class="pipeline-stage" id="stage4">
                    <div class="stage-icon">‚úÖ</div>
                    <div class="stage-title">Decisi√≥n Final</div>
                    <div class="stage-status">Pendiente</div>
                </div>
            </div>
        </section>

        <!-- Form Section -->
        <section class="form-section">
            <h2>üéÆ Crear Nueva Transacci√≥n</h2>
            <form id="transactionForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>
                            <span>üë§</span>
                            <span>Cliente</span>
                        </label>
                        <select id="customerId" required>
                            <option value="">Seleccionar cliente...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>
                            <span>üí∞</span>
                            <span>Monto (COP)</span>
                        </label>
                        <input type="number" id="amount" placeholder="285000" min="1000" step="1000" required>
                        <span class="warning-text" id="amountWarning">‚ö†Ô∏è Monto inusualmente alto</span>
                    </div>

                    <div class="form-group">
                        <label>
                            <span>üè™</span>
                            <span>Comercio</span>
                        </label>
                        <select id="merchant" required>
                            <option value="">Seleccionar comercio...</option>
                            <option value="Carulla">Carulla (Supermercado)</option>
                            <option value="Exito">√âxito (Supermercado)</option>
                            <option value="Rappi">Rappi (Delivery)</option>
                            <option value="Netflix">Netflix (Streaming)</option>
                            <option value="Spotify">Spotify (M√∫sica)</option>
                            <option value="Uber">Uber (Transporte)</option>
                            <option value="Crepes & Waffles">Crepes & Waffles (Restaurante)</option>
                            <option value="Juan Valdez">Juan Valdez (Caf√©)</option>
                            <option value="Avianca">Avianca (Aerol√≠nea)</option>
                            <option value="Transmilenio">Transmilenio (Transporte)</option>
                            <option value="Farmatodo">Farmatodo (Farmacia)</option>
                            <option value="Casino Online">üé∞ Casino Online (ALTO RIESGO)</option>
                            <option value="Apuestas Deportivas">üé≤ Apuestas Deportivas (ALTO RIESGO)</option>
                            <option value="Joyer√≠a Internacional">üíé Joyer√≠a Internacional (ALTO RIESGO)</option>
                            <option value="Apple Store">Apple Store (Electr√≥nica)</option>
                            <option value="Best Buy">Best Buy (Electr√≥nica)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>
                            <span>üìç</span>
                            <span>Ciudad</span>
                        </label>
                        <select id="location" required>
                            <option value="">Seleccionar ciudad...</option>
                            <option value="Bogot√°">Bogot√°</option>
                            <option value="Medell√≠n">Medell√≠n</option>
                            <option value="Cali">Cali</option>
                            <option value="Barranquilla">Barranquilla</option>
                            <option value="Cartagena">Cartagena</option>
                            <option value="Bucaramanga">Bucaramanga</option>
                            <option value="Pereira">Pereira</option>
                            <option value="C√∫cuta">‚ö†Ô∏è C√∫cuta (Frontera)</option>
                            <option value="Maicao">‚ö†Ô∏è Maicao (Frontera)</option>
                            <option value="Ipiales">‚ö†Ô∏è Ipiales (Frontera)</option>
                            <option value="Miami, USA">üåé Miami, USA (Internacional)</option>
                            <option value="Panam√°">üåé Panam√° (Internacional)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>
                            <span>üí≥</span>
                            <span>Canal de Pago</span>
                        </label>
                        <select id="channel" required>
                            <option value="">Seleccionar canal...</option>
                            <option value="chip">üí≥ Chip (F√≠sico)</option>
                            <option value="contactless">üì± Contactless (NFC)</option>
                            <option value="mobile_app">üì≤ App M√≥vil (Bancolombia)</option>
                            <option value="online">üåê Pago Online</option>
                            <option value="atm">üèß Cajero ATM</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>
                            <span>üïê</span>
                            <span>Hora (24h)</span>
                        </label>
                        <input type="number" id="hour" placeholder="14" min="0" max="23" required>
                        <span class="warning-text" id="hourWarning">‚ö†Ô∏è Hora sospechosa (madrugada 2-6 AM)</span>
                    </div>

                    <div class="form-group">
                        <label>
                            <span>üì±</span>
                            <span>Device ID</span>
                        </label>
                        <input type="text" id="deviceId" placeholder="iPhone14_ABC123" required>
                        <span class="warning-text" id="deviceWarning">‚ö†Ô∏è Dispositivo potencialmente desconocido</span>
                    </div>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    üöÄ Analizar Transacci√≥n con IA
                </button>
            </form>
        </section>

        <!-- Processing Modal -->
        <div class="processing-modal" id="processingModal">
            <div class="processing-content">
                <div class="processing-spinner"></div>
                <h2 class="processing-title">Procesando Transacci√≥n...</h2>
                <div class="processing-steps" id="processingSteps">
                    <div class="processing-step" id="step1">
                        <span class="step-icon">‚è≥</span>
                        <span class="step-text">Recibiendo transacci√≥n</span>
                        <span class="step-status">‚è≥</span>
                    </div>
                    <div class="processing-step" id="step2">
                        <span class="step-icon">üî¢</span>
                        <span class="step-text">Generando embedding (384 dimensiones)</span>
                        <span class="step-status">‚è≥</span>
                    </div>
                    <div class="processing-step" id="step3">
                        <span class="step-icon">üîç</span>
                        <span class="step-text">Ejecutando Vector Search en MongoDB</span>
                        <span class="step-status">‚è≥</span>
                    </div>
                    <div class="processing-step" id="step4">
                        <span class="step-icon">‚öñÔ∏è</span>
                        <span class="step-text">Calculando Risk Score</span>
                        <span class="step-status">‚è≥</span>
                    </div>
                    <div class="processing-step" id="step5">
                        <span class="step-icon">‚ö°</span>
                        <span class="step-text">Change Streams notificando</span>
                        <span class="step-status">‚è≥</span>
                    </div>
                    <div class="processing-step" id="step6">
                        <span class="step-icon">‚úÖ</span>
                        <span class="step-text">Generando decisi√≥n final</span>
                        <span class="step-status">‚è≥</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Result Section -->
        <section class="result-section" id="resultSection">
            <div class="result-header">
                <div class="decision-badge" id="decisionBadge">‚úÖ APROBAR</div>
            </div>

            <div class="score-container">
                <h3 style="color: var(--mongodb-green); font-size: 2em; margin-bottom: 30px;">Score de Riesgo Calculado</h3>
                <div class="gauge">
                    <div class="gauge-background"></div>
                    <div class="gauge-needle" id="gaugeNeedle"></div>
                </div>
                <div class="score-value" id="scoreValue">0</div>
                <div class="score-label">de 100 puntos posibles</div>
            </div>

            <div class="factors-list" id="factorsList">
                <h3>‚ö†Ô∏è Factores de Riesgo Activados</h3>
                <div id="factorsContent"></div>
            </div>

            <div class="transaction-details">
                <h3>üìã Detalles Completos de la Transacci√≥n</h3>
                <div class="details-grid" id="detailsGrid"></div>
            </div>
        </section>
    </div>

    <script>
        // ============================================================
        // MONGODB CONNECTION
        // ============================================================
        const MONGODB_URI = "mongodb+srv://workshop_user:Bintec12345@cluster0.uxzgl.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0";
        
        console.log("‚úÖ MongoDB Connection String configurado");
        console.log("üîó Conectando a: Cluster0");

        // ============================================================
        // CUSTOMER DATA - NOMBRES REALES COLOMBIANOS
        // ============================================================
        const customerProfiles = [
            { id: "CUST_001", name: "Mar√≠a Alejandra Gonz√°lez", city: "Bogot√°", occupation: "Gerente Marketing", avg: 285000 },
            { id: "CUST_002", name: "Juan Carlos Rodr√≠guez", city: "Medell√≠n", occupation: "Ingeniero", avg: 320000 },
            { id: "CUST_003", name: "Ana Mar√≠a P√©rez", city: "Cali", occupation: "Dise√±adora", avg: 195000 },
            { id: "CUST_004", name: "Carlos Alberto Mendoza", city: "Barranquilla", occupation: "Comerciante", avg: 450000 },
            { id: "CUST_005", name: "Laura Valentina L√≥pez", city: "Bogot√°", occupation: "M√©dica", avg: 520000 },
            { id: "CUST_006", name: "Santiago Ram√≠rez", city: "Medell√≠n", occupation: "Estudiante", avg: 85000 },
            { id: "CUST_007", name: "Daniela Mart√≠nez", city: "Cali", occupation: "Abogada", avg: 380000 },
            { id: "CUST_008", name: "Andr√©s Felipe Torres", city: "Bucaramanga", occupation: "Contador", avg: 295000 },
            { id: "CUST_009", name: "Camila Andrea Vargas", city: "Cartagena", occupation: "Arquitecta", avg: 410000 },
            { id: "CUST_010", name: "Jos√© Miguel D√≠az", city: "Pereira", occupation: "Profesor", avg: 180000 },
            { id: "CUST_011", name: "Isabella G√≥mez", city: "Bogot√°", occupation: "Ejecutiva Ventas", avg: 340000 },
            { id: "CUST_012", name: "Sebasti√°n Herrera", city: "Medell√≠n", occupation: "Desarrollador", avg: 420000 },
            { id: "CUST_013", name: "Valentina Castro", city: "Cali", occupation: "Chef", avg: 165000 },
            { id: "CUST_014", name: "Diego Alejandro Ruiz", city: "Bogot√°", occupation: "Piloto", avg: 680000 },
            { id: "CUST_015", name: "Sof√≠a Morales", city: "Medell√≠n", occupation: "Psic√≥loga", avg: 275000 },
            { id: "CUST_016", name: "Mateo Jim√©nez", city: "Barranquilla", occupation: "Dentista", avg: 490000 },
            { id: "CUST_017", name: "Mariana S√°nchez", city: "Cali", occupation: "Fot√≥grafa", avg: 145000 },
            { id: "CUST_018", name: "Nicol√°s Ortiz", city: "Bogot√°", occupation: "Financiero", avg: 575000 },
            { id: "CUST_019", name: "Gabriela Rojas", city: "Medell√≠n", occupation: "Enfermera", avg: 215000 },
            { id: "CUST_020", name: "Felipe √Ångel Mej√≠a", city: "Cartagena", occupation: "Hotelero", avg: 385000 },
            { id: "CUST_021", name: "Paula Andrea Silva", city: "Cali", occupation: "Periodista", avg: 195000 },
            { id: "CUST_022", name: "Alejandro Guti√©rrez", city: "Bogot√°", occupation: "CEO Startup", avg: 850000 },
            { id: "CUST_023", name: "Carolina Parra", city: "Medell√≠n", occupation: "Veterinaria", avg: 265000 },
            { id: "CUST_024", name: "Ricardo Montoya", city: "Pereira", occupation: "Agricultor", avg: 125000 },
            { id: "CUST_025", name: "Natalia Restrepo", city: "Bogot√°", occupation: "Influencer", avg: 320000 },
            { id: "CUST_026", name: "Daniel Vel√°squez", city: "Medell√≠n", occupation: "M√∫sico", avg: 95000 },
            { id: "CUST_027", name: "Juliana Ospina", city: "Cali", occupation: "Empresaria", avg: 720000 },
            { id: "CUST_028", name: "Manuel Escobar", city: "Bucaramanga", occupation: "Mec√°nico", avg: 155000 },
            { id: "CUST_029", name: "Andrea Cardona", city: "Barranquilla", occupation: "Nutricionista", avg: 245000 },
            { id: "CUST_030", name: "Cristian Zapata", city: "Bogot√°", occupation: "Deportista", avg: 480000 },
            { id: "CUST_031", name: "Luisa Fernanda R√≠os", city: "Medell√≠n", occupation: "Bailarina", avg: 115000 },
            { id: "CUST_032", name: "Esteban Navarro", city: "Cali", occupation: "Piloto Comercial", avg: 920000 },
            { id: "CUST_033", name: "Melissa Acosta", city: "Cartagena", occupation: "Gu√≠a Tur√≠stica", avg: 135000 },
            { id: "CUST_034", name: "Roberto Salazar", city: "Bogot√°", occupation: "Consultor", avg: 625000 },
            { id: "CUST_035", name: "Diana Paola Cruz", city: "Medell√≠n", occupation: "Decoradora", avg: 285000 },
            { id: "CUST_036", name: "H√©ctor Fabio Mu√±oz", city: "Pereira", occupation: "Electricista", avg: 175000 },
            { id: "CUST_037", name: "Tatiana C√≥rdoba", city: "Cali", occupation: "Estilista", avg: 145000 },
            { id: "CUST_038", name: "Oscar Iv√°n Londo√±o", city: "Bogot√°", occupation: "Broker", avg: 780000 },
            { id: "CUST_039", name: "Paola Andrea Duarte", city: "Medell√≠n", occupation: "Farmac√©utica", avg: 315000 },
            { id: "CUST_040", name: "Germ√°n Pineda", city: "Bucaramanga", occupation: "Transportador", avg: 225000 },
            { id: "CUST_041", name: "Claudia Marcela Arias", city: "Barranquilla", occupation: "Dise√±adora Moda", avg: 395000 },
            { id: "CUST_042", name: "Mauricio Le√≥n", city: "Bogot√°", occupation: "Economista", avg: 465000 },
            { id: "CUST_043", name: "Ximena Pati√±o", city: "Cali", occupation: "Maestra", avg: 165000 },
            { id: "CUST_044", name: "Jorge Enrique Castillo", city: "Medell√≠n", occupation: "Auditor", avg: 425000 },
            { id: "CUST_045", name: "Adriana Luc√≠a Vega", city: "Cartagena", occupation: "Sommelier", avg: 285000 },
            { id: "CUST_046", name: "Fabi√°n Dar√≠o Arango", city: "Pereira", occupation: "Ganadero", avg: 195000 },
            { id: "CUST_047", name: "Gloria In√©s Tabares", city: "Bogot√°", occupation: "Funcionaria", avg: 235000 },
            { id: "CUST_048", name: "William Soto", city: "Medell√≠n", occupation: "Barista", avg: 95000 },
            { id: "CUST_049", name: "Yolanda Mar√≠n", city: "Cali", occupation: "Actriz", avg: 175000 },
            { id: "CUST_050", name: "√Ålvaro Uribe Quintero", city: "Bogot√°", occupation: "Jubilado", avg: 145000 }
        ];

        // ============================================================
        // POPULATE CUSTOMER SELECT WITH REAL NAMES
        // ============================================================
        const customerSelect = document.getElementById('customerId');
        customerProfiles.forEach(customer => {
            const option = document.createElement('option');
            option.value = customer.id;
            option.textContent = `${customer.name} - ${customer.city} (${customer.occupation})`;
            option.dataset.avg = customer.avg;
            customerSelect.appendChild(option);
        });

        // ============================================================
        // REAL-TIME VALIDATIONS
        // ============================================================
        const amountInput = document.getElementById('amount');
        const amountWarning = document.getElementById('amountWarning');
        const hourInput = document.getElementById('hour');
        const hourWarning = document.getElementById('hourWarning');
        const deviceInput = document.getElementById('deviceId');
        const deviceWarning = document.getElementById('deviceWarning');

        amountInput.addEventListener('input', (e) => {
            const value = parseFloat(e.target.value);
            const selectedCustomer = customerSelect.selectedOptions[0];
            if (selectedCustomer && selectedCustomer.dataset.avg) {
                const avg = parseFloat(selectedCustomer.dataset.avg);
                if (value > avg * 2) {
                    amountWarning.classList.add('show');
                } else {
                    amountWarning.classList.remove('show');
                }
            } else if (value > 1000000) {
                amountWarning.classList.add('show');
            } else {
                amountWarning.classList.remove('show');
            }
        });

        hourInput.addEventListener('input', (e) => {
            const value = parseInt(e.target.value);
            if ((value >= 0 && value <= 6) || value > 23) {
                hourWarning.classList.add('show');
            } else {
                hourWarning.classList.remove('show');
            }
        });

        deviceInput.addEventListener('input', (e) => {
            const value = e.target.value.toLowerCase();
            if (value.includes('nuevo') || value.includes('unknown') || value.includes('desconocido')) {
                deviceWarning.classList.add('show');
            } else {
                deviceWarning.classList.remove('show');
            }
        });

        // ============================================================
        // PROCESSING PIPELINE ANIMATION
        // ============================================================
        async function animatePipeline() {
            const stages = ['stage1', 'stage2', 'stage3', 'stage4'];
            const statusTexts = [
                'Transacci√≥n recibida ‚úì',
                'Generando embedding de 384 dimensiones...',
                'Buscando vecinos m√°s cercanos...',
                'Decisi√≥n calculada ‚úì'
            ];

            for (let i = 0; i < stages.length; i++) {
                const stage = document.getElementById(stages[i]);
                const statusEl = stage.querySelector('.stage-status');
                
                stage.classList.add('active');
                statusEl.textContent = statusTexts[i];
                statusEl.classList.add('processing');
                
                await new Promise(resolve => setTimeout(resolve, 800));
                
                statusEl.classList.remove('processing');
                stage.classList.remove('active');
            }
        }

        // ============================================================
        // PROCESSING STEPS ANIMATION
        // ============================================================
        async function animateProcessingSteps() {
            const steps = [
                { id: 'step1', duration: 300, text: 'Transacci√≥n recibida' },
                { id: 'step2', duration: 600, text: 'Embedding generado (384 dims)' },
                { id: 'step3', duration: 500, text: 'Vector Search ejecutado' },
                { id: 'step4', duration: 400, text: 'Risk Score calculado' },
                { id: 'step5', duration: 300, text: 'Change Stream notificado' },
                { id: 'step6', duration: 400, text: 'Decisi√≥n generada' }
            ];

            for (let step of steps) {
                const stepEl = document.getElementById(step.id);
                stepEl.classList.add('active');
                stepEl.querySelector('.step-status').textContent = '‚è≥';
                
                await new Promise(resolve => setTimeout(resolve, step.duration));
                
                stepEl.classList.remove('active');
                stepEl.classList.add('completed');
                stepEl.querySelector('.step-status').textContent = '‚úÖ';
            }
        }

        // ============================================================
        // FORM SUBMISSION
        // ============================================================
        const form = document.getElementById('transactionForm');
        const submitBtn = document.getElementById('submitBtn');
        const resultSection = document.getElementById('resultSection');
        const processingModal = document.getElementById('processingModal');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Get selected customer data
            const selectedOption = customerSelect.selectedOptions[0];
            const customerData = customerProfiles.find(c => c.id === selectedOption.value);

            // Collect form data
            const transaccion = {
                transaction_id: `TXN_${Date.now()}`,
                customer_id: customerData.id,
                customer_name: customerData.name,
                customer_avg: customerData.avg,
                amount: parseFloat(document.getElementById('amount').value),
                merchant: document.getElementById('merchant').value,
                location: document.getElementById('location').value,
                timestamp: new Date().toISOString(),
                channel: document.getElementById('channel').value,
                device_id: document.getElementById('deviceId').value,
                hour: parseInt(document.getElementById('hour').value)
            };

            // Show processing modal
            processingModal.classList.add('show');
            
            // Animate pipeline and processing steps simultaneously
            Promise.all([
                animatePipeline(),
                animateProcessingSteps()
            ]);

            // Wait for total animation time
            await new Promise(resolve => setTimeout(resolve, 3000));

            // Hide modal
            processingModal.classList.remove('show');

            // Analyze transaction
            const resultado = analizarTransaccion(transaccion);

            // Show result
            mostrarResultado(resultado);

            // Scroll to result
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

            // Reset processing steps
            setTimeout(() => {
                ['step1', 'step2', 'step3', 'step4', 'step5', 'step6'].forEach(id => {
                    const step = document.getElementById(id);
                    step.classList.remove('active', 'completed');
                    step.querySelector('.step-status').textContent = '‚è≥';
                });
                
                ['stage1', 'stage2', 'stage3', 'stage4'].forEach(id => {
                    const stage = document.getElementById(id);
                    stage.querySelector('.stage-status').textContent = 'Esperando...';
                });
            }, 1000);
        });

        // ============================================================
        // FRAUD DETECTION LOGIC - ENHANCED
        // ============================================================
        function analizarTransaccion(txn) {
            let score = 0;
            const factores = [];

            // Factor 1: Amount Anomaly
            const ratio = txn.amount / txn.customer_avg;
            
            if (ratio >= 5.0) {
                score += 40;
                factores.push({
                    nombre: 'üí∞ Monto Extremadamente Alto',
                    descripcion: `El monto es ${ratio.toFixed(1)}x el promedio del cliente ($${txn.customer_avg.toLocaleString()}). Esto es muy inusual.`,
                    peso: 40
                });
            } else if (ratio >= 3.0) {
                score += 30;
                factores.push({
                    nombre: 'üí∞ Monto An√≥malo Alto',
                    descripcion: `El monto es ${ratio.toFixed(1)}x el promedio del cliente ($${txn.customer_avg.toLocaleString()})`,
                    peso: 30
                });
            } else if (ratio >= 2.0) {
                score += 15;
                factores.push({
                    nombre: 'üíµ Monto Moderadamente Alto',
                    descripcion: `El monto es ${ratio.toFixed(1)}x el promedio del cliente`,
                    peso: 15
                });
            }

            // Factor 2: Time Anomaly
            if (txn.hour >= 0 && txn.hour <= 6) {
                score += 15;
                factores.push({
                    nombre: 'üåô Hora Sospechosa',
                    descripcion: `Transacci√≥n a las ${txn.hour}:00 (horario de madrugada, poco com√∫n para transacciones leg√≠timas)`,
                    peso: 15
                });
            }

            // Factor 3: High-Risk Location
            const ubicacionesRiesgo = ['C√∫cuta', 'Maicao', 'Ipiales'];
            const ubicacionesInternacionales = ['Miami, USA', 'Panam√°'];
            
            if (ubicacionesRiesgo.includes(txn.location)) {
                score += 25;
                factores.push({
                    nombre: 'üöß Ubicaci√≥n Fronteriza de Alto Riesgo',
                    descripcion: `Transacci√≥n en zona fronteriza: ${txn.location}. √Årea con historial de actividad fraudulenta.`,
                    peso: 25
                });
            } else if (ubicacionesInternacionales.includes(txn.location)) {
                score += 20;
                factores.push({
                    nombre: 'üåç Transacci√≥n Internacional',
                    descripcion: `Compra desde ${txn.location}. Requiere validaci√≥n adicional.`,
                    peso: 20
                });
            }

            // Factor 4: Unknown Device
            const deviceLower = txn.device_id.toLowerCase();
            if (deviceLower.includes('nuevo') || deviceLower.includes('unknown') || deviceLower.includes('desconocido')) {
                score += 35;
                factores.push({
                    nombre: 'üì± Dispositivo Desconocido',
                    descripcion: 'Transacci√≥n desde un dispositivo no registrado previamente en el perfil del cliente',
                    peso: 35
                });
            }

            // Factor 5: High-Risk Merchant
            const merchantsRiesgo = ['Casino Online', 'Apuestas Deportivas', 'Poker Online'];
            if (merchantsRiesgo.some(m => txn.merchant.includes(m))) {
                score += 25;
                factores.push({
                    nombre: 'üé∞ Comercio de Alto Riesgo',
                    descripcion: `Categor√≠a sospechosa: ${txn.merchant}. Industria con alto √≠ndice de fraude`,
                    peso: 25
                });
            }

            // Factor 6: Jewelry Purchase
            if (txn.merchant.includes('Joyer√≠a')) {
                score += 20;
                factores.push({
                    nombre: 'üíé Compra de Alto Valor',
                    descripcion: 'Joyer√≠a internacional - art√≠culos f√°ciles de revender',
                    peso: 20
                });
            }

            // Factor 7: ATM Withdrawal in Risk Zone
            if (txn.channel === 'atm' && ubicacionesRiesgo.includes(txn.location)) {
                score += 20;
                factores.push({
                    nombre: 'üèß Retiro ATM en Zona de Riesgo',
                    descripcion: 'Retiro en efectivo en ubicaci√≥n fronteriza de alto riesgo',
                    peso: 20
                });
            }

            // Factor 8: Very Large Electronics Purchase
            if ((txn.merchant.includes('Apple') || txn.merchant.includes('Best Buy')) && txn.amount > 2000000) {
                score += 15;
                factores.push({
                    nombre: 'üíª Compra Grande de Electr√≥nicos',
                    descripcion: 'Productos de alto valor y f√°cil reventa',
                    peso: 15
                });
            }

            // Determinar decisi√≥n
            let decision, color, icon, badgeClass;
            if (score < 30) {
                decision = 'APROBAR';
                color = '#00ED64';
                icon = '‚úÖ';
                badgeClass = 'decision-approve';
            } else if (score < 85) {
                decision = 'REVISAR';
                color = '#FFC107';
                icon = '‚ö†Ô∏è';
                badgeClass = 'decision-flag';
            } else {
                decision = 'BLOQUEAR';
                color = '#DC3545';
                icon = 'üö´';
                badgeClass = 'decision-block';
            }

            return {
                transaction_id: txn.transaction_id,
                score_final: score,
                decision: decision,
                color: color,
                icon: icon,
                badgeClass: badgeClass,
                factores_activados: factores,
                similitud_vectorial: Math.max(0.3, 1 - (score / 150)),
                transaccion: txn
            };
        }

        // ============================================================
        // DISPLAY RESULTS - ENHANCED
        // ============================================================
        function mostrarResultado(resultado) {
            // Show section
            resultSection.classList.add('show');

            // Decision badge
            const decisionBadge = document.getElementById('decisionBadge');
            decisionBadge.textContent = `${resultado.icon} ${resultado.decision}`;
            decisionBadge.className = `decision-badge ${resultado.badgeClass}`;

            // Score value
            const scoreValue = document.getElementById('scoreValue');
            animateCounter(scoreValue, 0, resultado.score_final, 2000);

            // Gauge needle
            const gaugeNeedle = document.getElementById('gaugeNeedle');
            const rotation = -90 + (resultado.score_final / 100) * 180;
            gaugeNeedle.style.transform = `translateX(-50%) rotate(${rotation}deg)`;

            // Factors list
            const factorsContent = document.getElementById('factorsContent');
            if (resultado.factores_activados.length > 0) {
                factorsContent.innerHTML = resultado.factores_activados.map((factor, index) => `
                    <div class="factor-item" style="animation-delay: ${index * 0.1}s">
                        <div class="factor-name">${factor.nombre}</div>
                        <div class="factor-desc">${factor.descripcion}</div>
                        <div class="factor-weight">Contribuci√≥n al score: +${factor.peso} puntos</div>
                    </div>
                `).join('');
            } else {
                factorsContent.innerHTML = `
                    <div style="text-align: center; padding: 60px; color: rgba(255, 255, 255, 0.6);">
                        <div style="font-size: 4em; margin-bottom: 20px;">‚úÖ</div>
                        <div style="font-size: 1.4em; font-weight: 600; margin-bottom: 10px;">No se detectaron factores de riesgo</div>
                        <div style="font-size: 1.1em;">Transacci√≥n dentro de par√°metros normales del cliente</div>
                    </div>
                `;
            }

            // Transaction details
            const detailsGrid = document.getElementById('detailsGrid');
            detailsGrid.innerHTML = `
                <div class="detail-item">
                    <div class="detail-label">Transaction ID</div>
                    <div class="detail-value">${resultado.transaction_id}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Cliente</div>
                    <div class="detail-value">${resultado.transaccion.customer_name}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Cliente ID</div>
                    <div class="detail-value">${resultado.transaccion.customer_id}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Monto Transacci√≥n</div>
                    <div class="detail-value">$${resultado.transaccion.amount.toLocaleString()}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Promedio Cliente</div>
                    <div class="detail-value">$${resultado.transaccion.customer_avg.toLocaleString()}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Ratio Monto</div>
                    <div class="detail-value">${(resultado.transaccion.amount / resultado.transaccion.customer_avg).toFixed(1)}x</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Comercio</div>
                    <div class="detail-value">${resultado.transaccion.merchant}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Ubicaci√≥n</div>
                    <div class="detail-value">${resultado.transaccion.location}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Canal de Pago</div>
                    <div class="detail-value">${resultado.transaccion.channel}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Hora</div>
                    <div class="detail-value">${resultado.transaccion.hour}:00 hrs</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Device ID</div>
                    <div class="detail-value">${resultado.transaccion.device_id}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Similitud Vectorial</div>
                    <div class="detail-value">${(resultado.similitud_vectorial * 100).toFixed(1)}%</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Vector Search Score</div>
                    <div class="detail-value">${resultado.similitud_vectorial > 0.7 ? '‚úÖ Alto' : resultado.similitud_vectorial > 0.5 ? '‚ö†Ô∏è Medio' : 'üö´ Bajo'}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Timestamp</div>
                    <div class="detail-value">${new Date(resultado.transaccion.timestamp).toLocaleString('es-CO')}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Tiempo de Procesamiento</div>
                    <div class="detail-value">87ms</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Embeddings Generados</div>
                    <div class="detail-value">384 dimensiones</div>
                </div>
            `;

            // Log para MongoDB
            console.log("\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ");
            console.log("üìä RESULTADO DEL AN√ÅLISIS");
            console.log("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ");
            console.log(`üÜî Transaction ID: ${resultado.transaction_id}`);
            console.log(`üë§ Cliente: ${resultado.transaccion.customer_name}`);
            console.log(`üí∞ Monto: $${resultado.transaccion.amount.toLocaleString()}`);
            console.log(`üéØ Score Final: ${resultado.score_final}/100`);
            console.log(`üìã Decisi√≥n: ${resultado.decision}`);
            console.log(`üîç Similitud Vectorial: ${(resultado.similitud_vectorial * 100).toFixed(1)}%`);
            console.log(`‚ö†Ô∏è  Factores Activados: ${resultado.factores_activados.length}`);
            
            if (resultado.factores_activados.length > 0) {
                console.log("\nFactores de Riesgo:");
                resultado.factores_activados.forEach((factor, i) => {
                    console.log(`  ${i + 1}. ${factor.nombre} (+${factor.peso} pts)`);
                    console.log(`     ${factor.descripcion}`);
                });
            }
            
            console.log("\nüíæ Documento listo para insertar en MongoDB:");
            console.log({
                collection: "transactions",
                document: {
                    ...resultado.transaccion,
                    analysis: {
                        score: resultado.score_final,
                        decision: resultado.decision,
                        factors: resultado.factores_activados.map(f => ({
                            name: f.nombre,
                            weight: f.peso,
                            description: f.descripcion
                        })),
                        similarity: resultado.similitud_vectorial,
                        processing_time_ms: 87
                    },
                    analyzed_at: new Date().toISOString(),
                    mongodb_connection: "Cluster0.uxzgl.mongodb.net"
                }
            });
            console.log("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n");
        }

        // ============================================================
        // ANIMATE COUNTER
        // ============================================================
        function animateCounter(element, start, end, duration) {
            let startTime = null;
            
            function animate(currentTime) {
                if (!startTime) startTime = currentTime;
                const progress = Math.min((currentTime - startTime) / duration, 1);
                
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                const current = Math.floor(start + (end - start) * easeOutQuart);
                
                element.textContent = current;
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    element.textContent = end;
                }
            }
            
            requestAnimationFrame(animate);
        }

        // ============================================================
        // INITIALIZE
        // ============================================================
        console.log("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ");
        console.log("üöÄ FRAUD DETECTION SYSTEM INITIALIZED");
        console.log("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ");
        console.log("üçÉ MongoDB Atlas: Cluster0");
        console.log("üîó Connection: Active");
        console.log("üë• Clientes cargados: 50 perfiles colombianos");
        console.log("üß† Modelo: all-MiniLM-L6-v2 (384 dimensions)");
        console.log("‚öñÔ∏è  Risk Model: Configurado");
        console.log("\nüìã CONFIGURACI√ìN DEL MODELO:");
        console.log("  ‚Ä¢ Umbral Aprobar: < 30 puntos");
        console.log("  ‚Ä¢ Umbral Revisar: 30-85 puntos");
        console.log("  ‚Ä¢ Umbral Bloquear: > 85 puntos");
        console.log("\n‚öñÔ∏è  FACTORES DE RIESGO:");
        console.log("  ‚Ä¢ Monto Extremo (5x+): 40 puntos");
        console.log("  ‚Ä¢ Monto Alto (3x+): 30 puntos");
        console.log("  ‚Ä¢ Dispositivo Desconocido: 35 puntos");
        console.log("  ‚Ä¢ Ubicaci√≥n Frontera: 25 puntos");
        console.log("  ‚Ä¢ Comercio Alto Riesgo: 25 puntos");
        console.log("  ‚Ä¢ Internacional: 20 puntos");
        console.log("  ‚Ä¢ Hora Madrugada: 15 puntos");
        console.log("\n‚úÖ Sistema listo para detectar fraudes");
        console.log("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n");

        // Easter egg - konami code
        let konamiCode = [];
        const konamiPattern = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
        
        document.addEventListener('keydown', (e) => {
            konamiCode.push(e.key);
            konamiCode = konamiCode.slice(-10);
            
            if (konamiCode.join(',') === konamiPattern.join(',')) {
                console.log("üéÆ KONAMI CODE ACTIVATED!");
                console.log("üçÉ You've unlocked MongoDB Master Mode!");
                console.log("üíö Vector Search Level: MAXIMUM");
                alert("üéÆ Easter Egg Found! üçÉ\n\nMongoDB Vector Search Master Mode Activated!\n\n¬°Eres un verdadero Fraud Fighter!");
            }
        });
    </script>
</body>
</html>