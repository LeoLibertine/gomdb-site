<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongoDB - Design Review | Plataforma Anti-Fraude Bancolombia</title>
    <link rel="stylesheet" href="../../../styles/gomdb-global.css">
    <style>
        .section-hero {
            background: linear-gradient(135deg, var(--color-bg-primary) 0%, var(--color-bg-secondary) 100%);
            position: relative;
            overflow: hidden;
        }
        
        .floating-element {
            position: absolute;
            border-radius: 50%;
            background: var(--color-primary);
            opacity: 0.1;
            animation: float 6s ease-in-out infinite;
        }
        
        .floating-element:nth-child(1) { top: 10%; left: 10%; width: 100px; height: 100px; animation-delay: 0s; }
        .floating-element:nth-child(2) { top: 20%; right: 15%; width: 150px; height: 150px; animation-delay: 2s; }
        .floating-element:nth-child(3) { bottom: 15%; left: 20%; width: 80px; height: 80px; animation-delay: 4s; }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }
        
        .interactive-card {
            background: linear-gradient(135deg, rgba(13, 42, 61, 0.8) 0%, rgba(17, 35, 49, 0.6) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 237, 100, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .interactive-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 237, 100, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .interactive-card:hover::before {
            left: 100%;
        }
        
        .interactive-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: var(--color-primary);
            box-shadow: var(--shadow-glow);
        }
        
        .metric-counter {
            font-size: var(--text-4xl);
            font-weight: 700;
            color: var(--color-primary);
            transition: all 0.3s ease;
        }
        
        .metric-counter:hover {
            transform: scale(1.1);
            text-shadow: 0 0 20px var(--color-primary);
        }
        
        .code-preview {
            background: var(--color-bg-tertiary);
            border: 1px solid rgba(0, 237, 100, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            color: var(--color-text-secondary);
            white-space: pre-wrap;
            overflow-x: auto;
            position: relative;
        }
        
        .code-preview::before {
            content: 'MongoDB Schema';
            position: absolute;
            top: var(--spacing-sm);
            right: var(--spacing-md);
            background: var(--color-primary);
            color: var(--color-text-dark);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
            font-weight: 600;
        }
        
        .highlight-green { color: var(--color-primary); font-weight: 600; }
        .highlight-purple { color: var(--color-accent); font-weight: 600; }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--color-bg-secondary);
            border-radius: var(--radius-full);
            overflow: hidden;
            margin: var(--spacing-md) 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-primary), var(--color-accent));
            border-radius: var(--radius-full);
            transition: width 2s ease;
        }
        
        .tab-container {
            background: var(--color-bg-card);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            backdrop-filter: blur(10px);
        }
        
        .tab-buttons {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xl);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: var(--spacing-md);
        }
        
        .tab-button {
            padding: var(--spacing-md) var(--spacing-lg);
            background: transparent;
            color: var(--color-text-secondary);
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .tab-button.active {
            background: var(--color-primary);
            color: var(--color-text-dark);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-lg);
        }
        
        .performance-metric {
            text-align: center;
            padding: var(--spacing-lg);
            background: var(--color-bg-card);
            border-radius: var(--radius-lg);
            transition: transform 0.3s ease;
        }
        
        .performance-metric:hover {
            transform: translateY(-5px);
        }
        
        .performance-value {
            font-size: var(--text-3xl);
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: var(--spacing-sm);
        }
        
        .architecture-diagram {
            background: var(--color-bg-card);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .diagram-node {
            display: inline-block;
            padding: var(--spacing-lg);
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
            color: var(--color-text-dark);
            border-radius: var(--radius-lg);
            margin: var(--spacing-md);
            font-weight: 600;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .diagram-node:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-glow);
        }
        
        .scroll-indicator {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--color-bg-secondary);
            z-index: var(--z-fixed);
        }
        
        .scroll-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--color-primary), var(--color-accent));
            width: 0%;
            transition: width 0.1s ease;
        }
    </style>
</head>
<body>
    <!-- Indicador de progreso de scroll -->
    <div class="scroll-indicator">
        <div class="scroll-progress" id="scrollProgress"></div>
    </div>

    <!-- Navegación -->
    <nav class="navbar" id="navbar">
        <div class="container">
            <div class="navbar-container">
                <div class="navbar-logo">
                    <span class="text-gradient">MongoDB</span>
                </div>
                <div class="navbar-links">
                    <a href="#overview" class="navbar-link">Overview</a>
                    <a href="#architecture" class="navbar-link">Arquitectura</a>
                    <a href="#performance" class="navbar-link">Performance</a>
                    <a href="#implementation" class="navbar-link">Implementación</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero section-hero" id="overview">
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        
        <div class="container">
            <div class="text-center">
                <div class="badge badge-primary mb-4 animate-fadeIn">
                    Design Review • MongoDB Architecture
                </div>
                <h1 class="animate-slideInLeft mb-4">
                    <span class="text-gradient">Plataforma de Monitoreo</span><br>
                    Transaccional Anti-Fraude
                </h1>
                <p class="text-xl color-text-secondary mb-6 animate-slideInRight">
                    Arquitectura MongoDB optimizada para 300 asesores de Bancolombia<br>
                    Rendimiento de milisegundos • Escalabilidad infinita • Trazabilidad completa
                </p>
                <div class="flex justify-center gap-4 animate-fadeIn">
                    <a href="#architecture" class="btn btn-primary btn-lg">
                        Explorar Arquitectura
                    </a>
                    <a href="#performance" class="btn btn-secondary btn-lg">
                        Ver Métricas
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Métricas Clave -->
    <section class="section">
        <div class="container">
            <div class="performance-grid">
                <div class="performance-metric interactive-card">
                    <div class="performance-value metric-counter" data-target="300">0</div>
                    <div class="color-text-secondary">Asesores Concurrentes</div>
                </div>
                <div class="performance-metric interactive-card">
                    <div class="performance-value metric-counter" data-target="99.9">0</div>
                    <div class="color-text-secondary">% Disponibilidad</div>
                </div>
                <div class="performance-metric interactive-card">
                    <div class="performance-value metric-counter" data-target="5">0</div>
                    <div class="color-text-secondary">ms Tiempo Respuesta</div>
                </div>
                <div class="performance-metric interactive-card">
                    <div class="performance-value metric-counter" data-target="1000">0</div>
                    <div class="color-text-secondary">GB/día Procesados</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Arquitectura Principal -->
    <section class="section" id="architecture">
        <div class="container">
            <div class="text-center mb-6">
                <h2 class="text-gradient mb-4">El Patrón de Colección Única: Fundamento Técnico</h2>
                <p class="text-lg color-text-secondary">
                    Justificación detallada del modelo de datos desnormalizado
                </p>
            </div>

            <!-- Explicación detallada de una sola colección -->
            <div class="interactive-card mb-6">
                <h3 class="highlight-green mb-4">¿Por qué una sola colección?</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="highlight-purple mb-3">Rendimiento Optimizado</h4>
                        <p class="color-text-secondary mb-4">
                            En MongoDB, el rendimiento se maximiza al alinear el modelo de datos con los patrones de acceso. 
                            El caso de uso principal es que un asesor consulte la actividad de un cliente específico.
                        </p>
                        <div class="code-preview">
// ✅ Con una sola colección (RÁPIDO)
db.transaccionesMonitoreadas.find({
  "cliente.numeroIdentificacion": "123456789"
})
// → Una sola operación, milisegundos

// ❌ Con múltiples colecciones (LENTO)
// 1. Buscar en tabla transacciones
// 2. JOIN con tabla clientes  
// 3. JOIN con tabla canales
// 4. JOIN con tabla análisis
// → Múltiples operaciones, segundos
                        </div>
                    </div>
                    <div>
                        <h4 class="highlight-purple mb-3">Eliminación de JOINs Costosos</h4>
                        <p class="color-text-secondary mb-4">
                            Las operaciones JOIN ($lookup en MongoDB) son las más costosas en cualquier sistema de base de datos 
                            porque requieren múltiples accesos a disco y cómputo para combinar datos.
                        </p>
                        <div class="performance-metric">
                            <div class="performance-value">0</div>
                            <div class="color-text-secondary">JOINs necesarios</div>
                        </div>
                        <p class="color-text-secondary mt-3">
                            Al tener todos los datos relevantes (canal, transacción, Biotcach, Rule Manager) 
                            en un solo documento, eliminamos completamente la necesidad de uniones.
                        </p>
                    </div>
                </div>
                
                <div class="mt-6">
                    <h4 class="highlight-purple mb-3">Atomicidad y Consistencia</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="card text-center">
                            <h5 class="color-text-primary">Escritura Atómica</h5>
                            <p class="color-text-secondary">Cada transacción es un evento atómico. Las escrituras y actualizaciones son atómicas a nivel de documento.</p>
                        </div>
                        <div class="card text-center">
                            <h5 class="color-text-primary">Consistencia Garantizada</h5>
                            <p class="color-text-secondary">No hay riesgo de inconsistencias entre tablas relacionadas porque todo está en un documento.</p>
                        </div>
                        <div class="card text-center">
                            <h5 class="color-text-primary">Lógica Simplificada</h5>
                            <p class="color-text-secondary">La aplicación no necesita manejar transacciones complejas entre múltiples colecciones.</p>
                        </div>
                    </div>
                </div>

                <div class="mt-6">
                    <h4 class="highlight-purple mb-3">Prevención de Anti-Patrones</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="card-bordered card">
                            <h5 class="color-error mb-3">❌ Anti-Patrón: Unbounded Array</h5>
                            <div class="code-preview">
// MAL: Un documento por cliente con array infinito
{
  "_id": "cliente_123",
  "transacciones": [
    { ... }, { ... }, { ... }
    // Array crece infinitamente
    // Viola límite de 16MB
    // Performance degrada
  ]
}
                            </div>
                        </div>
                        <div class="card-bordered card">
                            <h5 class="color-success mb-3">✅ Patrón Correcto: Un Documento por Transacción</h5>
                            <div class="code-preview">
// BIEN: Documento independiente por transacción
{
  "_id": ObjectId("..."),
  "idTransaccion": "TRN-2025-ABCD-1234",
  "cliente": { "numeroIdentificacion": "123" },
  "origen": { ... },
  "destino": { ... }
  // Tamaño constante y pequeño
  // Escalabilidad infinita
}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-button active" onclick="switchTab('schema')">Esquema MongoDB</button>
                    <button class="tab-button" onclick="switchTab('indexing')">Estrategia de Indexación</button>
                    <button class="tab-button" onclick="switchTab('sharding')">Sharding</button>
                    <button class="tab-button" onclick="switchTab('lifecycle')">Ciclo de Vida</button>
                </div>

                <div id="schema" class="tab-content active">
                    <h3 class="mb-4">Estructura del Documento</h3>
                    <div class="code-preview">
{
  <span class="highlight-green">"idTransaccion"</span>: "TRN-2025-ABCD-1234",
  <span class="highlight-green">"timestampTransaccion"</span>: ISODate("2025-08-15T17:30:00Z"),
  <span class="highlight-green">"estado"</span>: "Enriquecida",

  <span class="highlight-purple">"cliente"</span>: {
    "tipoIdentificacion": "CC",
    "numeroIdentificacion": "123456789"
  },

  <span class="highlight-purple">"origen"</span>: {
    "producto": {
      "tipo": "SAVINGS_ACCOUNT",
      "numero": "0123456789"
    },
    "monto": 150000.00,
    "moneda": "COP"
  },

  <span class="highlight-purple">"destino"</span>: {
    "banco": "007",
    "cliente": {
      "tipoIdentificacion": "CC",
      "numeroIdentificacion": "987654321"
    },
    "producto": {
      "tipo": "CREDIT_CARD",
      "numero": "9876543210"
    }
  },

  <span class="highlight-purple">"canal"</span>: {
    "codigo": "MOBILE_BANKING",
    "idAplicacion": "BancolombiaAppV3",
    "dispositivo": {
      "id": "device-uuid-5678",
      "ip": "200.1.2.3",
      "userAgent": "Mozilla/5.0...",
      "geolocalizacion": {
        "pais": "CO",
        "ciudad": "Medellin"
      }
    }
  },

  <span class="highlight-purple">"analisisRiesgo"</span>: {
    "biotcach": {
      "score": 95,
      "riskLevel": "LOW",
      "decision": "APPROVE",
      "comportamientos": ["Uso de VPN", "Anomalía de Navegación"]
    },
    "ruleManager": {
      "rrr_score_1": 85.5,
      "rrr_action_code": "00",
      "smh_reason_code": "N/A"
    },
    "mai": {
      "score": 88
    }
  },

  <span class="highlight-green">"historialActualizaciones"</span>: [
    {
      "componente": "Canal",
      "timestamp": ISODate("2025-08-15T17:30:00Z"),
      "estadoPrevio": "N/A",
      "estadoNuevo": "Iniciada"
    },
    {
      "componente": "Biotcach",
      "timestamp": ISODate("2025-08-15T17:30:03Z"),
      "estadoPrevio": "Iniciada",
      "estadoNuevo": "Enriquecida"
    }
  ]
}
                    </div>
                </div>

                <div id="indexing" class="tab-content">
                    <h3 class="mb-4">Estrategia de Indexación Detallada</h3>
                    
                    <!-- Explicación detallada de índices -->
                    <div class="interactive-card mb-6">
                        <h4 class="highlight-green mb-4">¿Por qué estos índices específicos?</h4>
                        <p class="color-text-secondary mb-4">
                            Una buena estrategia de indexación es la diferencia entre una aplicación lenta y una instantánea. 
                            Los índices son estructuras de datos especiales que almacenan un subconjunto de los datos de la colección 
                            de una forma fácil de recorrer, como un índice en un libro.
                        </p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h5 class="highlight-purple mb-3">Sin Índices (Scan Completo)</h5>
                                <div class="code-preview">
// MongoDB debe revisar TODOS los documentos
// Tiempo: O(n) - crece linealmente
// Con 100M documentos = 30+ segundos

db.transacciones.find({
  "cliente.numeroIdentificacion": "123456789"
})
// Examina: 100,000,000 documentos
// Encuentra: 50 transacciones del cliente
                                </div>
                            </div>
                            <div>
                                <h5 class="highlight-purple mb-3">Con Índices (Búsqueda Directa)</h5>
                                <div class="code-preview">
// MongoDB va directamente a los documentos relevantes
// Tiempo: O(log n) - crecimiento logarítmico
// Con 100M documentos = milisegundos

// Usa índice compuesto optimizado
db.transacciones.find({
  "cliente.numeroIdentificacion": "123456789"
})
// Examina: ~50 documentos (solo los del cliente)
// Encuentra: 50 transacciones del cliente
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 gap-6">
                        <!-- Índice Compuesto Principal -->
                        <div class="interactive-card">
                            <h4 class="highlight-green mb-3">1. Índice Compuesto Principal (El Caballo de Batalla)</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <div class="code-preview">
// Definición del índice
{
  "cliente.numeroIdentificacion": 1,
  "timestampTransaccion": -1
}

// Comando de creación
db.transaccionesMonitoreadas.createIndex(
  {
    "cliente.numeroIdentificacion": 1,
    "timestampTransaccion": -1
  },
  { 
    name: "idx_cliente_timestamp",
    background: true
  }
)
                                    </div>
                                </div>
                                <div>
                                    <h5 class="highlight-purple mb-3">Queries Optimizadas</h5>
                                    <div class="space-y-3">
                                        <div class="card-bordered card">
                                            <h6 class="color-text-primary">Buscar todas las transacciones de un cliente</h6>
                                            <div class="code-preview mt-2">
db.transaccionesMonitoreadas.find({
  "cliente.numeroIdentificacion": "123456789"
})
// ⚡ Covered Query - Ultra rápido
                                            </div>
                                        </div>
                                        <div class="card-bordered card">
                                            <h6 class="color-text-primary">Buscar con ordenamiento temporal</h6>
                                            <div class="code-preview mt-2">
db.transaccionesMonitoreadas.find({
  "cliente.numeroIdentificacion": "123456789"
}).sort({ "timestampTransaccion": -1 })
// ⚡ Sin ordenamiento en memoria
                                            </div>
                                        </div>
                                        <div class="card-bordered card">
                                            <h6 class="color-text-primary">Búsqueda por rango de fechas</h6>
                                            <div class="code-preview mt-2">
db.transaccionesMonitoreadas.find({
  "cliente.numeroIdentificacion": "123456789",
  "timestampTransaccion": {
    $gte: ISODate("2025-08-01"),
    $lt: ISODate("2025-09-01")
  }
})
// ⚡ Utiliza ambos campos del índice
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <h5 class="highlight-purple mb-3">¿Por qué este orden específico?</h5>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="card text-center">
                                        <h6 class="color-text-primary">Cardinalidad</h6>
                                        <p class="color-text-secondary">numeroIdentificacion tiene alta cardinalidad (millones de valores únicos), ideal como primer campo</p>
                                    </div>
                                    <div class="card text-center">
                                        <h6 class="color-text-primary">Selectividad</h6>
                                        <p class="color-text-secondary">Filtra drasticamente el conjunto de datos antes del ordenamiento temporal</p>
                                    </div>
                                    <div class="card text-center">
                                        <h6 class="color-text-primary">Covered Queries</h6>
                                        <p class="color-text-secondary">Las consultas se resuelven completamente desde el índice sin acceder al documento</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Índice Único -->
                        <div class="interactive-card">
                            <h4 class="highlight-green mb-3">2. Índice Único para Búsqueda Directa</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <div class="code-preview">
// Definición del índice único
{
  "idTransaccion": 1
}

// Comando de creación
db.transaccionesMonitoreadas.createIndex(
  { "idTransaccion": 1 },
  { 
    unique: true,
    name: "idx_id_transaccion_unique",
    background: true
  }
)
                                    </div>
                                </div>
                                <div>
                                    <h5 class="highlight-purple mb-3">Beneficios Clave</h5>
                                    <div class="space-y-3">
                                        <div class="card">
                                            <h6 class="color-text-primary">🔍 Búsqueda Instantánea</h6>
                                            <p class="color-text-secondary">Encuentra una transacción específica en O(log n) tiempo</p>
                                        </div>
                                        <div class="card">
                                            <h6 class="color-text-primary">🛡️ Integridad de Datos</h6>
                                            <p class="color-text-secondary">Previene IDs duplicados a nivel de base de datos</p>
                                        </div>
                                        <div class="card">
                                            <h6 class="color-text-primary">⚡ Operaciones Atómicas</h6>
                                            <p class="color-text-secondary">Upserts seguros basados en ID único</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <h5 class="highlight-purple mb-3">Query Optimizada</h5>
                                <div class="code-preview">
// Búsqueda directa de transacción
db.transaccionesMonitoreadas.findOne({
  "idTransaccion": "TRN-2025-ABCD-1234"
})
// ⚡ Tiempo: ~1ms independientemente del tamaño de la colección
// 🔒 Garantiza unicidad: Impossible insertar ID duplicado
                                </div>
                            </div>
                        </div>

                        <!-- Índice TTL -->
                        <div class="interactive-card">
                            <h4 class="highlight-green mb-3">3. Índice TTL (Time To Live) - Depuración Automática</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <div class="code-preview">
// Definición del índice TTL
{
  "timestampTransaccion": 1
}

// Comando de creación (6 meses = 15552000 segundos)
db.transaccionesMonitoreadas.createIndex(
  { "timestampTransaccion": 1 },
  { 
    expireAfterSeconds: 15552000,
    name: "idx_timestamp_ttl",
    background: true
  }
)
                                    </div>
                                </div>
                                <div>
                                    <h5 class="highlight-purple mb-3">Ventajas del TTL Automático</h5>
                                    <div class="space-y-3">
                                        <div class="card">
                                            <h6 class="color-text-primary">🤖 Automatización Total</h6>
                                            <p class="color-text-secondary">MongoDB elimina documentos automáticamente sin intervención manual</p>
                                        </div>
                                        <div class="card">
                                            <h6 class="color-text-primary">⚡ Bajo Impacto</h6>
                                            <p class="color-text-secondary">Proceso en segundo plano que no afecta el rendimiento</p>
                                        </div>
                                        <div class="card">
                                            <h6 class="color-text-primary">📊 Control de Volumen</h6>
                                            <p class="color-text-secondary">Mantiene el tamaño de la colección bajo control automáticamente</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <h5 class="highlight-purple mb-3">Comparación: TTL vs Scripts Manuales</h5>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="card-bordered card">
                                        <h6 class="color-error mb-3">❌ Scripts Manuales de Borrado</h6>
                                        <ul class="color-text-secondary space-y-1">
                                            <li>• Requieren desarrollo y mantenimiento</li>
                                            <li>• Riesgo de impacto en performance</li>
                                            <li>• Pueden fallar sin supervisión</li>
                                            <li>• Necesitan scheduling externo</li>
                                            <li>• Complejidad en manejo de errores</li>
                                        </ul>
                                    </div>
                                    <div class="card-bordered card">
                                        <h6 class="color-success mb-3">✅ TTL Nativo de MongoDB</h6>
                                        <ul class="color-text-secondary space-y-1">
                                            <li>• Funcionalidad nativa optimizada</li>
                                            <li>• Proceso distribuido y eficiente</li>
                                            <li>• Automático y confiable</li>
                                            <li>• Sin código adicional que mantener</li>
                                            <li>• Integrado con el motor de storage</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Análisis de índices existentes -->
                        <div class="interactive-card">
                            <h4 class="highlight-green mb-3">4. Análisis de los 8 Índices Existentes</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h5 class="highlight-purple mb-3">Impacto de Múltiples Índices</h5>
                                    <div class="space-y-3">
                                        <div class="card">
                                            <h6 class="color-warning">📈 Sobrecarga en Escrituras</h6>
                                            <p class="color-text-secondary">Cada índice adicional ralentiza INSERT, UPDATE, DELETE</p>
                                        </div>
                                        <div class="card">
                                            <h6 class="color-warning">💾 Consumo de RAM</h6>
                                            <p class="color-text-secondary">Cada índice consume memoria para mantenerse en cache</p>
                                        </div>
                                        <div class="card">
                                            <h6 class="color-warning">💽 Espacio en Disco</h6>
                                            <p class="color-text-secondary">Índices innecesarios ocupan espacio valuable</p>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h5 class="highlight-purple mb-3">Estrategia de Optimización</h5>
                                    <div class="progress-bar mb-3">
                                        <div class="progress-fill" style="width: 85%"></div>
                                    </div>
                                    <p class="color-text-secondary mb-4">Objetivo: Reducir de 8 a 3 índices estratégicos</p>
                                    
                                    <div class="code-preview">
// Análisis de uso de índices existentes
db.transaccionesMonitoreadas.aggregate([
  { $indexStats: {} }
])

// Identificar índices no utilizados
// Consolidar funcionalidades similares  
// Mantener solo los índices críticos
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="sharding" class="tab-content">
                    <h3 class="mb-4">Escalabilidad Horizontal</h3>
                    <div class="architecture-diagram">
                        <h4 class="mb-4 highlight-green">Shard Key: cliente.numeroIdentificacion (hashed)</h4>
                        <div class="diagram-node">mongos Router</div>
                        <div style="margin: var(--spacing-lg) 0; color: var(--color-text-secondary);">↓ Distribución Hash ↓</div>
                        <div class="diagram-node">Shard A</div>
                        <div class="diagram-node">Shard B</div>
                        <div class="diagram-node">Shard C</div>
                        <div class="diagram-node">Shard N</div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                        <div class="interactive-card text-center">
                            <h5 class="highlight-green">Alta Cardinalidad</h5>
                            <p class="color-text-secondary">Millones de valores únicos de identificación</p>
                        </div>
                        <div class="interactive-card text-center">
                            <h5 class="highlight-green">Distribución Uniforme</h5>
                            <p class="color-text-secondary">Escrituras balanceadas entre shards</p>
                        </div>
                        <div class="interactive-card text-center">
                            <h5 class="highlight-green">Consultas Dirigidas</h5>
                            <p class="color-text-secondary">Lecturas eficientes a shard específico</p>
                        </div>
                    </div>
                </div>

                <div id="lifecycle" class="tab-content">
                    <h3 class="mb-4">Trazabilidad del Ciclo de Vida</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="interactive-card">
                            <h4 class="highlight-purple mb-3">Flujo de Estados</h4>
                            <div class="space-y-3">
                                <div class="flex items-center gap-3">
                                    <div class="badge badge-secondary">1</div>
                                    <span>Iniciada (Canal)</span>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="badge badge-secondary">2</div>
                                    <span>Enriquecida (Biotcach)</span>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="badge badge-secondary">3</div>
                                    <span>Analizada (Rule Manager)</span>
                                </div>
                                <div class="flex items-center gap-3">
                                    <div class="badge badge-primary">4</div>
                                    <span>Completada</span>
                                </div>
                            </div>
                        </div>
                        <div class="interactive-card">
                            <h4 class="highlight-purple mb-3">Ventajas del Historial</h4>
                            <ul class="space-y-2 color-text-secondary">
                                <li>✓ Depuración de fallos por componente</li>
                                <li>✓ Análisis de latencia de procesamiento</li>
                                <li>✓ Auditoría y cumplimiento normativo</li>
                                <li>✓ Trazabilidad inmutable</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Performance y Beneficios -->
    <section class="section" id="performance">
        <div class="container">
            <div class="text-center mb-6">
                <h2 class="text-gradient mb-4">Rendimiento y Escalabilidad</h2>
                <p class="text-lg color-text-secondary">
                    Arquitectura orientada al rendimiento y la evolución
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="interactive-card">
                    <h3 class="highlight-green mb-4">Beneficios Técnicos</h3>
                    <div class="space-y-4">
                        <div class="flex items-start gap-3">
                            <div class="badge badge-primary">1</div>
                            <div>
                                <h5 class="color-text-primary">Rendimiento Excepcional</h5>
                                <p class="color-text-secondary">Tiempos de respuesta de milisegundos para consultas de asesores</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="badge badge-primary">2</div>
                            <div>
                                <h5 class="color-text-primary">Alta Escalabilidad</h5>
                                <p class="color-text-secondary">Crecimiento a múltiples terabytes sin degradación</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="badge badge-primary">3</div>
                            <div>
                                <h5 class="color-text-primary">Trazabilidad Completa</h5>
                                <p class="color-text-secondary">Visibilidad total del ciclo de vida para auditoría</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="badge badge-primary">4</div>
                            <div>
                                <h5 class="color-text-primary">Bajo Mantenimiento</h5>
                                <p class="color-text-secondary">Depuración automatizada y lógica simplificada</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="interactive-card">
                    <h3 class="highlight-green mb-4">Optimizaciones Clave</h3>
                    <div class="space-y-4">
                        <div>
                            <h5 class="color-text-primary mb-2">Eliminación de JOINs</h5>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 100%"></div>
                            </div>
                            <p class="color-text-secondary mt-2">Una sola operación de lectura por consulta</p>
                        </div>
                        <div>
                            <h5 class="color-text-primary mb-2">Atomicidad de Escritura</h5>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 100%"></div>
                            </div>
                            <p class="color-text-secondary mt-2">Consistencia garantizada a nivel de documento</p>
                        </div>
                        <div>
                            <h5 class="color-text-primary mb-2">Desnormalización Selectiva</h5>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 90%"></div>
                            </div>
                            <p class="color-text-secondary mt-2">Solo información crítica duplicada</p>
                        </div>
                        <div>
                            <h5 class="color-text-primary mb-2">TTL Automático</h5>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 85%"></div>
                            </div>
                            <p class="color-text-secondary mt-2">Gestión automatizada del ciclo de vida</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Implementación -->
    <section class="section" id="implementation">
        <div class="container">
            <div class="text-center mb-6">
                <h2 class="text-gradient mb-4">Próximos Pasos</h2>
                <p class="text-lg color-text-secondary">
                    Hoja de ruta para la implementación
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="interactive-card">
                    <div class="badge badge-primary mb-3">Fase 1</div>
                    <h4 class="mb-3">Análisis de Índices Existentes</h4>
                    <p class="color-text-secondary mb-4">
                        Evaluación de los 8 índices actuales para optimización y consolidación
                    </p>
                    <ul class="color-text-secondary space-y-1">
                        <li>• Análisis de uso</li>
                        <li>• Identificación de redundancias</li>
                        <li>• Plan de migración</li>
                    </ul>
                </div>

                <div class="interactive-card">
                    <div class="badge badge-primary mb-3">Fase 2</div>
                    <h4 class="mb-3">Implementación del Esquema</h4>
                    <p class="color-text-secondary mb-4">
                        Creación de la colección transaccionesMonitoreadas con índices optimizados
                    </p>
                    <ul class="color-text-secondary space-y-1">
                        <li>• Colección única</li>
                        <li>• Índices estratégicos</li>
                        <li>• TTL configuration</li>
                    </ul>
                </div>

                <div class="interactive-card">
                    <div class="badge badge-primary mb-3">Fase 3</div>
                    <h4 class="mb-3">Configuración de Sharding</h4>
                    <p class="color-text-secondary mb-4">
                        Preparación para escalabilidad horizontal con shard key optimizada
                    </p>
                    <ul class="color-text-secondary space-y-1">
                        <li>• Shard key hashed</li>
                        <li>• Distribución uniforme</li>
                        <li>• Monitoreo de performance</li>
                    </ul>
                </div>
            </div>

            <div class="text-center mt-8">
                <div class="interactive-card inline-block">
                    <h4 class="text-gradient mb-3">Leo, Arquitecto de Soluciones MongoDB</h4>
                    <p class="color-text-secondary">
                        Disponible para discutir este análisis en mayor detalle y refinar cualquier aspecto según sus comentarios.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Scroll progress indicator
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('scrollProgress').style.width = scrolled + '%';
        });

        // Navbar scroll effect
        window.addEventListener('scroll', () => {
            const navbar = document.getElementById('navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('navbar-scrolled');
            } else {
                navbar.classList.remove('navbar-scrolled');
            }
        });

        // Counter animation
        function animateCounter(element, target) {
            let current = 0;
            const increment = target / 100;
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    element.textContent = target;
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current);
                }
            }, 20);
        }

        // Intersection Observer for counter animation
        const observerOptions = {
            threshold: 0.5,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const counter = entry.target;
                    const target = parseInt(counter.getAttribute('data-target'));
                    animateCounter(counter, target);
                    observer.unobserve(counter);
                }
            });
        }, observerOptions);

        // Observe all counters
        document.querySelectorAll('.metric-counter').forEach(counter => {
            observer.observe(counter);
        });

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    const offsetTop = target.offsetTop - 80; // Account for navbar height
                    window.scrollTo({
                        top: offsetTop,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Interactive card hover effects
        document.querySelectorAll('.interactive-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-8px) scale(1.02)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });

        // Diagram node interaction
        document.querySelectorAll('.diagram-node').forEach(node => {
            node.addEventListener('click', function() {
                // Create a ripple effect
                const ripple = document.createElement('div');
                ripple.style.position = 'absolute';
                ripple.style.borderRadius = '50%';
                ripple.style.background = 'rgba(0, 237, 100, 0.6)';
                ripple.style.transform = 'scale(0)';
                ripple.style.animation = 'ripple 0.6s linear';
                ripple.style.left = '50%';
                ripple.style.top = '50%';
                ripple.style.width = '100px';
                ripple.style.height = '100px';
                ripple.style.marginLeft = '-50px';
                ripple.style.marginTop = '-50px';
                
                this.style.position = 'relative';
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        });

        // Add ripple animation keyframes
        const style = document.createElement('style');
        style.textContent = `
            @keyframes ripple {
                to {
                    transform: scale(2);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Performance metrics animation on scroll
        const performanceObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const progressBars = entry.target.querySelectorAll('.progress-fill');
                    progressBars.forEach((bar, index) => {
                        setTimeout(() => {
                            bar.style.width = bar.style.width;
                        }, index * 200);
                    });
                }
            });
        }, { threshold: 0.3 });

        document.querySelectorAll('.interactive-card').forEach(card => {
            if (card.querySelector('.progress-fill')) {
                performanceObserver.observe(card);
            }
        });

        // Add floating animation to elements
        function addFloatingAnimation() {
            const floatingElements = document.querySelectorAll('.floating-element');
            floatingElements.forEach((element, index) => {
                element.style.animationDelay = `${index * 2}s`;
            });
        }

        // Initialize animations when page loads
        window.addEventListener('load', () => {
            addFloatingAnimation();
            
            // Add entrance animations to cards
            const cards = document.querySelectorAll('.interactive-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(50px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });

        // Add parallax effect to hero section
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            const parallaxElements = document.querySelectorAll('.floating-element');
            
            parallaxElements.forEach((element, index) => {
                const speed = (index + 1) * 0.1;
                element.style.transform = `translateY(${scrolled * speed}px) rotate(${scrolled * 0.02}deg)`;
            });
        });

        // Code preview syntax highlighting enhancement
        document.querySelectorAll('.code-preview').forEach(codeBlock => {
            codeBlock.addEventListener('mouseenter', function() {
                this.style.borderColor = 'var(--color-primary)';
                this.style.boxShadow = '0 0 20px rgba(0, 237, 100, 0.3)';
            });
            
            codeBlock.addEventListener('mouseleave', function() {
                this.style.borderColor = 'rgba(0, 237, 100, 0.3)';
                this.style.boxShadow = 'none';
            });
        });

        // Add typing effect to key elements
        function typeWriter(element, text, speed = 50) {
            let i = 0;
            element.innerHTML = '';
            
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            }
            type();
        }

        // Enhanced interaction for metric counters
        document.querySelectorAll('.metric-counter').forEach(counter => {
            counter.addEventListener('click', function() {
                const target = parseInt(this.getAttribute('data-target'));
                this.style.transform = 'scale(1.2)';
                this.style.color = 'var(--color-accent)';
                
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                    this.style.color = 'var(--color-primary)';
                }, 300);
                
                // Re-animate the counter
                animateCounter(this, target);
            });
        });

        // Add glow effect to important elements on hover
        document.querySelectorAll('.text-gradient, .navbar-logo').forEach(element => {
            element.addEventListener('mouseenter', function() {
                this.style.filter = 'drop-shadow(0 0 10px var(--color-primary))';
            });
            
            element.addEventListener('mouseleave', function() {
                this.style.filter = 'none';
            });
        });

        console.log('MongoDB Design Review - Interactive Dashboard Loaded');
        console.log('MongoDB Architecture for Bancolombia Anti-Fraud Platform');
    </script>
</body>
</html>